# 시퀀스 다이어그램

```mermaid
sequenceDiagram
    participant User
    participant API
    participant 상품 서비스
    participant 주문 서비스
    participant 결제 서비스

    User->>API: 주문 생성 요청
    API->>상품 서비스: 재고 확인
    상품 서비스-->>API: 재고 충분
    API->>주문 서비스: 주문 데이터 저장
    Note over API,주문 서비스: 주문 생성 완료

    alt 결제 성공
        API->>결제 서비스: 결제 요청
        결제 서비스->>결제 서비스: 사용자 잔액 확인
        결제 서비스-->>API: 결제 성공
        API->>결제 서비스: 사용자 잔액 차감
        결제 서비스->>결제 서비스: 결제 데이터 저장
        결제 서비스-->>User: 결제 완료
    else 결제 실패
        API->>결제 서비스: 결제 요청
        결제 서비스->>결제 서비스: 사용자 잔액 확인
        결제 서비스-->>API: 결제 실패
        API->>주문 서비스: 주문 취소 요청
        주문 서비스->>상품 서비스: 재고 복구 요청
        상품 서비스-->>주문 서비스: 재고 복구 완료
        주문 서비스-->>User: 주문 취소 완료
    end

```

# Description

- 사용자가 주문을 생성하면 API를 통해 상품 서비스에 재고 확인을 요청한다.
- 상품 서비스는 재고가 충분하면 API에 재고 충분을 응답한다.
- API는 주문 서비스에 주문 데이터를 저장한다.
- 주문 서비스는 주문 생성 완료를 API에 응답한다.
- 결제가 성공하면 결제 서비스에 결제 요청을 한다.
- 결제 서비스는 사용자 잔액을 확인하고 결제 성공을 API에 응답한다.
- 결제 서비스는 사용자 잔액을 차감하고 결제 데이터를 저장한다.
- 결제 완료를 사용자에게 응답한다.
- 결제가 실패하면 결제 실패를 API에 응답한다.
- API는 주문 취소 요청을 주문 서비스에 전달한다.
- 주문 서비스는 상품 서비스에 재고 복구 요청을 한다.
- 상품 서비스는 재고 복구 완료를 주문 서비스에 응답한다.
- 주문 취소 완료를 사용자에게 응답한다.
